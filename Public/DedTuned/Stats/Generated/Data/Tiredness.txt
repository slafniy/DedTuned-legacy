# Apply Tiredness mechanics for all possible player-controlled characters
new entry "_Hero"
type "Character"
using "_Hero"
data "Passives" "ShortResting;NonLethal;WeaponThrow;Perform;AttackOfOpportunity;DarknessRules;CombatStartAttack;TIREDNESS_ADD_STACK_IN_COMBAT;TIREDNESS_REMOVE_STACKS_ON_SHORT_REST"

new entry "ORIGIN_Karlach"
type "Character"
using "ORIGIN_Karlach"
data "Passives" "ShortResting;NonLethal;WeaponThrow;Perform;AttackOfOpportunity;DarknessRules;CombatStartAttack;ORI_Karlach_SweatImmune;TIREDNESS_ADD_STACK_IN_COMBAT;TIREDNESS_REMOVE_STACKS_ON_SHORT_REST"



# DEBUFF: shows current level of Tiredness
new entry "TIREDNESS_DEBUFF_STACKS"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h34f7d8d7gc6b8g4fa2g81f5g7636c1a91f99;1"
data "Description" "h2c80a44eg9020g4d93gbdebg50abf17df167;1"
data "Icon" "Status_Sleep"
data "StackId" "TIREDNESS_DEBUFF_STACKS"
data "StackType" "Additive"
data "StatusPropertyFlags" "FreezeDuration;MultiplyEffectsByDuration;ApplyToDead"
data "TickType" "StartTurn"
data "TickFunctors" "IF(StatusDurationEqualOrMoreThan(SELF,'TIREDNESS_DEBUFF_STACKS',1) and not HasStatus('TIREDNESS_DEBUFF_LEVEL_1')):ApplyStatus(SELF,TIREDNESS_DEBUFF_LEVEL_1,100,-1);IF(StatusDurationEqualOrMoreThan(SELF,'TIREDNESS_DEBUFF_STACKS',2) and not HasStatus('TIREDNESS_DEBUFF_LEVEL_2')):ApplyStatus(SELF,TIREDNESS_DEBUFF_LEVEL_2,100,-1);IF(StatusDurationEqualOrMoreThan(SELF,'TIREDNESS_DEBUFF_STACKS',3) and not HasStatus('TIREDNESS_DEBUFF_LEVEL_3')):ApplyStatus(SELF,TIREDNESS_DEBUFF_LEVEL_3,100,-1);IF(StatusDurationEqualOrMoreThan(SELF,'TIREDNESS_DEBUFF_STACKS',4) and not HasStatus('TIREDNESS_DEBUFF_LEVEL_4')):ApplyStatus(SELF,TIREDNESS_DEBUFF_LEVEL_4,100,-1);IF(StatusDurationEqualOrMoreThan(SELF,'TIREDNESS_DEBUFF_STACKS',5) and not HasStatus('TIREDNESS_DEBUFF_DEATH')):ApplyStatus(SELF,TIREDNESS_DEBUFF_DEATH,100,-1);IF(StatusDurationLessThan(SELF,'TIREDNESS_DEBUFF_STACKS',1) and HasStatus('TIREDNESS_DEBUFF_LEVEL_1')):RemoveStatus(SELF,TIREDNESS_DEBUFF_LEVEL_1);IF(StatusDurationLessThan(SELF,'TIREDNESS_DEBUFF_STACKS',2) and HasStatus('TIREDNESS_DEBUFF_LEVEL_2')):RemoveStatus(SELF,TIREDNESS_DEBUFF_LEVEL_2);IF(StatusDurationLessThan(SELF,'TIREDNESS_DEBUFF_STACKS',3) and HasStatus('TIREDNESS_DEBUFF_LEVEL_3')):RemoveStatus(SELF,TIREDNESS_DEBUFF_LEVEL_3);IF(StatusDurationLessThan(SELF,'TIREDNESS_DEBUFF_STACKS',4) and HasStatus('TIREDNESS_DEBUFF_LEVEL_4')):RemoveStatus(SELF,TIREDNESS_DEBUFF_LEVEL_4);IF(StatusDurationLessThan(SELF,'TIREDNESS_DEBUFF_STACKS',5) and HasStatus('TIREDNESS_DEBUFF_DEATH')):RemoveStatus(SELF,TIREDNESS_DEBUFF_DEATH)"

# DEBUFF: Tiredness level 1
new entry "TIREDNESS_DEBUFF_LEVEL_1"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h34f7d8d7gc6b8g4fa2g81f5g7636c1a91f99;1"
data "Description" "h2c80a44eg9020g4d93gbdebg50abf17df167;1"
data "Icon" "Status_Prone"

# DEBUFF: Tiredness level 2
new entry "TIREDNESS_DEBUFF_LEVEL_2"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h34f7d8d7gc6b8g4fa2g81f5g7636c1a91f99;1"
data "Description" "h2c80a44eg9020g4d93gbdebg50abf17df167;1"
data "Icon" "Status_Exhaustion"

# DEBUFF: Tiredness level 3
new entry "TIREDNESS_DEBUFF_LEVEL_3"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h34f7d8d7gc6b8g4fa2g81f5g7636c1a91f99;1"
data "Description" "h2c80a44eg9020g4d93gbdebg50abf17df167;1"
data "Icon" "Status_Restrained"

# DEBUFF: Tiredness level 4
new entry "TIREDNESS_DEBUFF_LEVEL_4"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h34f7d8d7gc6b8g4fa2g81f5g7636c1a91f99;1"
data "Description" "h2c80a44eg9020g4d93gbdebg50abf17df167;1"
data "Icon" "Status_Paralyzed"

# DEBUFF: Tiredness level 5 - DEATH
new entry "TIREDNESS_DEBUFF_DEATH"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h4568bcf8g51b7g42c3gb7a5g259d2b0d12f4;1"
data "Description" "h9a276103g3eb8g4a50g90aeg5828c7d4aad6;1"
data "Icon" "Status_Dying"
data "TickType" "EndTurn"
data "TickFunctors" "Kill()"



# PASSIVE: Adds +1 stack of Tiredness every time when character turn starts in combat
new entry "TIREDNESS_ADD_STACK_IN_COMBAT"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnTurn"
data "Conditions" "Combat()"
data "StatsFunctors" "ApplyStatus(SELF,TIREDNESS_DEBUFF_STACKS,100,1)"

# PASSIVE: Removes N stacks of Tiredness on Short Rest
new entry "TIREDNESS_REMOVE_STACKS_ON_SHORT_REST"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnShortRest"
data "StatsFunctors" "ApplyStatus(SELF,TIREDNESS_DEBUFF_STACKS,100,-1)"
